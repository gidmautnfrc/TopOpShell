function e = e_andes(mesh,U,h,signatures)%e_andes(Cosmat,p_shell,t,U,C,dseta)
%%Preliminaries
 
dseta1=signatures.dseta1;
dseta2=signatures.dseta2;
dseta3=signatures.dseta3;

%Local coordinates

x1 =  mesh.localcoordinates.x1';
x2 =  mesh.localcoordinates.x2';
x3 =  mesh.localcoordinates.x3';
y1 =  mesh.localcoordinates.y1';
y2 =  mesh.localcoordinates.y2';
y3 =  mesh.localcoordinates.y3';

x12 = x1-x2;
y12 = y1-y2;
x23 = x2-x3;
y23 = y2-y3;
x31 = x3-x1;
y31 = y3-y1;


A=mesh.A';

Um=U.Um;

um1=Um(1,:)';
um2=Um(2,:)';
um3=Um(3,:)';
um4=Um(4,:)';
um5=Um(5,:)';
um6=Um(6,:)';
um7=Um(7,:)';
um8=Um(8,:)';
um9=Um(9,:)';

   
e1=[(1/8).*A.^(-1).*(4.*um3.*y12+4.*um1.*y23+um7.*y12.*y23+(-1).*um9.*y12.* ...
  y23+4.*um2.*y31+(-1).*um8.*y12.*y31+um9.*y12.*y31+(-1).*um7.*y23.*y31+ ...
  um8.*y23.*y31)+(1/4).*A.^(-2).*(A.*(dseta2.*(um7+(-1).*um9)+(-1).* ...
  dseta3.*(2.*um7+um8+um9)+dseta1.*(um7+um8+2.*um9)).*y12.*y23+A.*(( ...
  dseta1.*((-1).*um8+um9)+dseta3.*(um7+2.*um8+um9)+(-1).*dseta2.*(um7+um8+ ...
  2.*um9)).*y12+(dseta3.*((-1).*um7+um8)+dseta2.*(2.*um7+um8+um9)+(-1).* ...
  dseta1.*(um7+2.*um8+um9)).*y23).*y31+(um3.*x12+um1.*x23+um2.*x31+um6.* ...
  y12+um4.*y23+um5.*y31).*(dseta3.*y12.*(y23+(-1).*y31)+dseta2.*(y12+(-1) ...
  .*y23).*y31+dseta1.*y23.*((-1).*y12+y31)))];

e2=[(1/8).*A.^(-1).*((-4).*um6.*x12+(-4).*um4.*x23+(um7+(-1).*um9).*x12.* ...
  x23+((-4).*um5+(-1).*um8.*x12+um9.*x12+(-1).*um7.*x23+um8.*x23).*x31)+( ...
  1/4).*A.^(-2).*(A.*(dseta2.*(um7+(-1).*um9)+(-1).*dseta3.*(2.*um7+um8+ ...
  um9)+dseta1.*(um7+um8+2.*um9)).*x12.*x23+A.*((dseta1.*((-1).*um8+um9)+ ...
  dseta3.*(um7+2.*um8+um9)+(-1).*dseta2.*(um7+um8+2.*um9)).*x12+(dseta3.*( ...
  (-1).*um7+um8)+dseta2.*(2.*um7+um8+um9)+(-1).*dseta1.*(um7+2.*um8+um9)) ...
  .*x23).*x31+(dseta3.*x12.*(x23+(-1).*x31)+dseta2.*(x12+(-1).*x23).*x31+ ...
  dseta1.*x23.*((-1).*x12+x31)).*(um3.*x12+um1.*x23+um2.*x31+um6.*y12+ ...
  um4.*y23+um5.*y31))];

e3=[(1/4).*A.^(-1).*((-2).*um3.*x12+(-2).*um1.*x23+(-2).*um2.*x31+2.*um6.* ...
  y12+um7.*x12.*y12+(-1).*um8.*x12.*y12+2.*um4.*y23+(um8+(-1).*um9).*x23.* ...
  y23+2.*um5.*y31+(-1).*um7.*x31.*y31+um9.*x31.*y31)+(1/4).*A.^(-2).*(( ...
  um3.*x12+um1.*x23+um2.*x31+um6.*y12+um4.*y23+um5.*y31).*((-1).*dseta3.* ...
  x23.*y12+dseta3.*x31.*y12+dseta1.*(x12+(-1).*x31).*y23+dseta2.*x31.*(( ...
  -1).*y12+y23)+dseta1.*x23.*(y12+(-1).*y31)+dseta2.*((-1).*x12+x23).*y31+ ...
  dseta3.*x12.*((-1).*y23+y31))+A.*(dseta2.*((-1).*um7.*x23.*y12+um9.* ...
  x23.*y12+um7.*x31.*y12+um8.*x31.*y12+2.*um9.*x31.*y12+(-1).*um7.*x12.* ...
  y23+um9.*x12.*y23+(-2).*um7.*x31.*y23+(-1).*um8.*x31.*y23+(-1).*um9.* ...
  x31.*y23+(um7+um8+2.*um9).*x12.*y31+(-1).*(2.*um7+um8+um9).*x23.*y31)+ ...
  dseta1.*((-1).*(um7.*x23+um8.*(x23+(-1).*x31)+um9.*(2.*x23+x31)).*y12+( ...
  -1).*(um7+um8+2.*um9).*x12.*y23+(um7+2.*um8+um9).*x31.*y23+(um8+(-1).* ...
  um9).*x12.*y31+(um7+2.*um8+um9).*x23.*y31)+dseta3.*(um9.*(x23.*y12+(-1) ...
  .*x31.*y12+x12.*y23+(-1).*x12.*y31)+um8.*(x23.*y12+(-2).*x31.*y12+x12.* ...
  y23+(-1).*x31.*y23+(-1).*(2.*x12+x23).*y31)+um7.*((-1).*x31.*y12+2.* ...
  x12.*y23+x31.*y23+(-1).*x12.*y31+x23.*(2.*y12+y31)))))];

e=[e1'; e2'; e3'];
% e=e.*h^3;
% --------------- FALTA CONSIDERAR h
% --------------- FALTA CONSIDERAR h
% --------------- FALTA CONSIDERAR h
end